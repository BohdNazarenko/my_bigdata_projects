import pandas as pd
import numpy as np

# Создание DataFrame с пропущенными значениями
df = pd.DataFrame({
    'A': [1, 2, np.nan, 4, 5],
    'B': [np.nan, 2, 3, np.nan, 5],
    'C': [1, 2, 3, 4, 5]
})

# Удаление строк с любыми пропущенными значениями
df_dropped = df.dropna()
print("Удаление строк с пропущенными значениями:")
print(df_dropped)

# Удаление столбцов, содержащих пропущенные значения
df_dropped_columns = df.dropna(axis=1)
print("\nУдаление столбцов с пропущенными значениями:")
print(df_dropped_columns)

# Заполнение пропущенных значений средним значением по столбцу
df_filled_mean = df.fillna(df.mean())
print("\nЗаполнение пропущенных значений средним:")
print(df_filled_mean)

# Заполнение пропущенных значений постоянным значением
df_filled_constant = df.fillna(0)
print("\nЗаполнение пропущенных значений нулями:")
print(df_filled_constant)


# Создание DataFrame с дубликатами
df_duplicates = pd.DataFrame({
    'A': [1, 2, 2, 4, 5],
    'B': [1, 2, 2, 4, 5]
})

# Удаление дубликатов
df_no_duplicates = df_duplicates.drop_duplicates()
print("\nУдаление дубликатов:")
print(df_no_duplicates)

# Создание DataFrame с типами данных для преобразования
df_types = pd.DataFrame({
    'A': ['1', '2', '3', '4'],
    'B': ['10.1', '20.2', '30.3', '40.4']
})

# Изменение типа данных столбца
df_types['A'] = df_types['A'].astype(int)
df_types['B'] = df_types['B'].astype(float)
print("\nИзменение типов данных:")
print(df_types)


# Создание DataFrame с выбросами (аномальные значения)
df_outliers = pd.DataFrame({
    'A': [1, 2, 3, 1000, 5]
})

# Удаление выбросов
df_no_outliers = df_outliers[df_outliers['A'] < 100]
print("\nУдаление выбросов:")
print(df_no_outliers)

#Results:
# Удаление строк с пропущенными значениями:
#      A    B  C
# 1  2.0  2.0  2
# 4  5.0  5.0  5
#
# Удаление столбцов с пропущенными значениями:
#    C
# 0  1
# 1  2
# 2  3
# 3  4
# 4  5
#
# Заполнение пропущенных значений средним:
#      A         B  C
# 0  1.0  3.333333  1
# 1  2.0  2.000000  2
# 2  3.0  3.000000  3
# 3  4.0  3.333333  4
# 4  5.0  5.000000  5
#
# Заполнение пропущенных значений нулями:
#      A    B  C
# 0  1.0  0.0  1
# 1  2.0  2.0  2
# 2  0.0  3.0  3
# 3  4.0  0.0  4
# 4  5.0  5.0  5
#
# Удаление дубликатов:
#    A  B
# 0  1  1
# 1  2  2
# 3  4  4
# 4  5  5
#
# Изменение типов данных:
#    A     B
# 0  1  10.1
# 1  2  20.2
# 2  3  30.3
# 3  4  40.4
#
# Удаление выбросов:
#    A
# 0  1
# 1  2
# 2  3
# 4  5

